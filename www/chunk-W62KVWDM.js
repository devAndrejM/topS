import{a as se,b as de}from"./chunk-KISLQ7NL.js";import{A as v,B as T,C as M,Ca as H,D as O,E,Ea as L,F as b,Fa as N,G as y,Ga as B,H as k,Ha as D,I as R,Ia as U,J as j,Ja as Q,Ka as $,La as K,Ma as W,Na as G,Oa as Y,Pa as q,Qa as J,Ra as X,Sa as Z,Ta as ee,Wa as te,Za as ie,_a as ne,ab as oe,bb as re,cb as ae,fb as ce,gb as le,h as x,i as C,l as w,m as n,n as h,na as F,o as z,p as m,pa as V,r as d,s as i,t as o,u,ua as A,v as I,w as f,x as p,y as s,z as g}from"./chunk-GZM6PKPG.js";import"./chunk-U7EZXO5C.js";import"./chunk-QUJFQN2Y.js";import"./chunk-AIVSP72F.js";import"./chunk-ZXAJZD2J.js";import"./chunk-ZPF3UMI3.js";import"./chunk-HGGI7JS7.js";import"./chunk-YBMMNUCE.js";import"./chunk-42QLUVHM.js";import"./chunk-7FY2OE2O.js";import"./chunk-6LWJNHS4.js";import"./chunk-PTNI3WES.js";import"./chunk-MTHZ7MWU.js";import"./chunk-WI5MSH4N.js";import"./chunk-J7JZC7PI.js";import"./chunk-CKP3SGE2.js";import"./chunk-S2CNIDDQ.js";import"./chunk-GD6VFYTL.js";import"./chunk-YDARD4JA.js";import"./chunk-C5MO2JOW.js";import"./chunk-DKVMNLG7.js";import"./chunk-R5HL6L5F.js";import"./chunk-M2X7KQLB.js";import"./chunk-3IVKBF6N.js";import"./chunk-C5RQ2IC2.js";import"./chunk-42C7ZIID.js";import{e as S}from"./chunk-JHI3MBHO.js";function pe(t,c){if(t&1){let e=I();i(0,"ion-chip",14),f("click",function(){let a=x(e).$implicit,l=p(2);return C(l.onCategorySelect(a.name))}),i(1,"ion-label"),s(2),o()()}if(t&2){let e=c.$implicit,r=p(2);d("color",r.selectedCategory===e.name?"primary":"medium"),n(2),T("",e.name," (",e.count,")")}}function me(t,c){if(t&1){let e=I();i(0,"ion-chip",15),f("click",function(){x(e);let a=p(2);return C(a.clearCategory())}),u(1,"ion-icon",16),i(2,"ion-label"),s(3,"Ukloni filter"),o()()}}function ge(t,c){if(t&1&&(i(0,"div",11)(1,"ion-card")(2,"ion-card-header")(3,"ion-card-title"),s(4,"Kategorije"),o()(),i(5,"ion-card-content"),m(6,pe,3,3,"ion-chip",12)(7,me,4,0,"ion-chip",13),o()()()),t&2){let e=p();n(6),d("ngForOf",e.searchResults.categories),n(),d("ngIf",e.selectedCategory)}}function _e(t,c){t&1&&(i(0,"ion-chip",19)(1,"ion-label"),s(2,"Iz cache memorije"),o()())}function ue(t,c){if(t&1&&(i(0,"div",17)(1,"ion-item")(2,"ion-label")(3,"h3"),s(4),o(),i(5,"p"),s(6),m(7,_e,3,0,"ion-chip",18),o()()()()),t&2){let e=p();n(4),v("",e.searchResults.totalResults," rezultata prona\u0111eno"),n(2),v(" ",e.getTimeAgo(e.searchResults.lastUpdated)," "),n(),d("ngIf",e.searchResults.isFromCache)}}function he(t,c){if(t&1&&(i(0,"ion-chip",38)(1,"ion-label"),s(2),o()()),t&2){let e=c.$implicit;n(2),g(e)}}function fe(t,c){if(t&1&&(i(0,"span",39),s(1),o()),t&2){let e=p(2).$implicit;n(),v(" +",e.sizes.length-5," vi\u0161e ")}}function ve(t,c){if(t&1&&(i(0,"div",33)(1,"ion-label",34),s(2,"Veli\u010Dine:"),o(),i(3,"div",35),m(4,he,3,1,"ion-chip",36)(5,fe,2,1,"span",37),o()()),t&2){let e=p().$implicit;n(4),d("ngForOf",e.sizes.slice(0,5)),n(),d("ngIf",e.sizes.length>5)}}function xe(t,c){if(t&1){let e=I();i(0,"ion-col",22)(1,"ion-card",23),f("click",function(){let a=x(e).$implicit,l=p(2);return C(l.openProduct(a))}),u(2,"img",24),i(3,"ion-card-header")(4,"ion-card-subtitle"),s(5),o(),i(6,"ion-card-title",25),s(7),o()(),i(8,"ion-card-content")(9,"div",26)(10,"h2",27),s(11),o(),i(12,"ion-chip",28)(13,"ion-label"),s(14),o()()(),i(15,"p",29),s(16),o(),m(17,ve,6,2,"div",30),i(18,"ion-button",31),u(19,"ion-icon",32),s(20," Pogledaj proizvod "),o()()()()}if(t&2){let e=c.$implicit,r=p(2);n(2),d("src",e.imageUrl,w)("alt",e.name),n(3),T("",e.brand," \u2022 ",e.storeName),n(2),g(e.name),n(4),g(r.formatPrice(e.price,e.currency)),n(),d("color",e.inStock?"success":"danger"),n(2),g(e.inStock?"Dostupno":"Nedostupno"),n(2),g(e.description),n(),d("ngIf",e.sizes.length>0)}}function Ce(t,c){if(t&1&&(i(0,"div",20)(1,"ion-grid")(2,"ion-row"),m(3,xe,21,10,"ion-col",21),o()()()),t&2){let e=p();n(3),d("ngForOf",e.searchResults.products)}}function Ie(t,c){t&1&&(i(0,"div",40)(1,"ion-card")(2,"ion-card-content",41),u(3,"ion-icon",42),i(4,"h2"),s(5,"Nema rezultata"),o(),i(6,"p"),s(7,"Poku\u0161ajte s drugim pojmom za pretra\u017Eivanje"),o()()()())}function be(t,c){t&1&&(i(0,"div",43)(1,"ion-card")(2,"ion-card-content",41),u(3,"ion-spinner",44),i(4,"p"),s(5,"Pretra\u017Eujem trgovine..."),o()()()())}var je=(()=>{let c=class c{constructor(r,a,l,_){this.apiService=r,this.userService=a,this.loadingController=l,this.toastController=_,this.searchQuery="",this.searchResults=null,this.selectedCategory="",this.isLoading=!1}ngOnInit(){}onSearch(){return S(this,null,function*(){if(!this.searchQuery.trim())return;this.isLoading=!0;let r=yield this.loadingController.create({message:"Pretra\u017Eujem..."});yield r.present();try{let a=this.userService.getCurrentUserId();this.searchResults=(yield this.apiService.search(this.searchQuery,a,this.selectedCategory).toPromise())||null}catch(a){console.error("Search error:",a),this.showToast("Gre\u0161ka pri pretra\u017Eivanju","danger")}finally{this.isLoading=!1,yield r.dismiss()}})}onCategorySelect(r){this.selectedCategory=r,this.onSearch()}clearCategory(){this.selectedCategory="",this.onSearch()}openProduct(r){window.open(r.affiliateUrl,"_blank")}showToast(r,a="primary"){return S(this,null,function*(){yield(yield this.toastController.create({message:r,duration:2e3,color:a})).present()})}formatPrice(r,a){return new Intl.NumberFormat("hr-HR",{style:"currency",currency:a==="HRK"?"HRK":a}).format(r)}getTimeAgo(r){let a=new Date(r),_=Math.floor((new Date().getTime()-a.getTime())/(1e3*60*60));return _<1?"prije manje od sat vremena":_===1?"prije sat vremena":"prije  sati"}};c.\u0275fac=function(a){return new(a||c)(h(se),h(de),h(oe),h(re))},c.\u0275cmp=z({type:c,selectors:[["app-tab1"]],decls:21,vars:17,consts:[[3,"translucent"],[3,"fullscreen"],["collapse","condense"],["size","large"],[1,"search-container"],["debounce","500",3,"ngModelChange","ionInput","ngModel","placeholder"],["class","categories-section",4,"ngIf"],["class","results-info",4,"ngIf"],["class","products-grid",4,"ngIf"],["class","no-results",4,"ngIf"],["class","loading-section",4,"ngIf"],[1,"categories-section"],[3,"color","click",4,"ngFor","ngForOf"],["color","danger",3,"click",4,"ngIf"],[3,"click","color"],["color","danger",3,"click"],["name","close"],[1,"results-info"],["color","warning","size","small",4,"ngIf"],["color","warning","size","small"],[1,"products-grid"],["size","12","size-md","6","size-lg","4",4,"ngFor","ngForOf"],["size","12","size-md","6","size-lg","4"],[1,"product-card",3,"click"],[1,"product-image",3,"src","alt"],[1,"product-title"],[1,"price-section"],[1,"price"],["size","small",3,"color"],[1,"description"],["class","sizes-section",4,"ngIf"],["expand","block","fill","solid","color","primary",1,"buy-button"],["name","open-outline","slot","start"],[1,"sizes-section"],[1,"sizes-label"],[1,"sizes-container"],["color","light","size","small",4,"ngFor","ngForOf"],["class","more-sizes",4,"ngIf"],["color","light","size","small"],[1,"more-sizes"],[1,"no-results"],[1,"ion-text-center"],["name","search-outline","size","large","color","medium"],[1,"loading-section"],["name","crescent"]],template:function(a,l){a&1&&(i(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),s(3),b(4,"translate"),o()()(),i(5,"ion-content",1)(6,"ion-header",2)(7,"ion-toolbar")(8,"ion-title",3),s(9),b(10,"translate"),o()()(),i(11,"ion-card")(12,"ion-card-content")(13,"div",4)(14,"ion-searchbar",5),b(15,"translate"),E("ngModelChange",function(P){return O(l.searchQuery,P)||(l.searchQuery=P),P}),f("ionInput",function(){return l.onSearch()}),o()()()(),m(16,ge,8,2,"div",6)(17,ue,8,3,"div",7)(18,Ce,4,1,"div",8)(19,Ie,8,0,"div",9)(20,be,6,0,"div",10),o()),a&2&&(d("translucent",!0),n(3),v(" ",y(4,11,"TABS.SEARCH")," "),n(2),d("fullscreen",!0),n(4),g(y(10,13,"TABS.SEARCH")),n(5),M("ngModel",l.searchQuery),d("placeholder",y(15,15,"SEARCH.PLACEHOLDER")),n(2),d("ngIf",l.searchResults&&l.searchResults.categories.length>0),n(),d("ngIf",l.searchResults),n(),d("ngIf",l.searchResults&&l.searchResults.products.length>0),n(),d("ngIf",l.searchResults&&l.searchResults.products.length===0),n(),d("ngIf",l.isLoading&&!l.searchResults))},dependencies:[ae,L,N,B,D,U,Q,$,K,W,G,Y,q,J,X,Z,ee,te,ie,ne,H,j,k,R,A,F,V,le,ce],styles:[".search-container[_ngcontent-%COMP%]{padding:8px 0}.categories-section[_ngcontent-%COMP%]{margin:16px 0}.results-info[_ngcontent-%COMP%]{margin:8px 0}.products-grid[_ngcontent-%COMP%]{padding:8px}.product-card[_ngcontent-%COMP%]{height:100%;cursor:pointer;transition:transform .2s ease}.product-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.product-image[_ngcontent-%COMP%]{width:100%;height:200px;object-fit:cover;background-color:#f5f5f5}.product-title[_ngcontent-%COMP%]{font-size:1rem;line-height:1.3;height:2.6rem;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.price-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.price[_ngcontent-%COMP%]{margin:0;font-weight:700;color:var(--ion-color-primary)}.description[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-medium);margin-bottom:12px;height:2.7rem;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.sizes-section[_ngcontent-%COMP%]{margin-bottom:16px}.sizes-label[_ngcontent-%COMP%]{font-size:.85rem;font-weight:500;color:var(--ion-color-dark)}.sizes-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:4px;margin-top:4px;align-items:center}.more-sizes[_ngcontent-%COMP%]{font-size:.8rem;color:var(--ion-color-medium);margin-left:4px}.buy-button[_ngcontent-%COMP%]{margin-top:8px}.no-results[_ngcontent-%COMP%], .loading-section[_ngcontent-%COMP%]{margin:32px 16px}.no-results[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-bottom:16px}.loading-section[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{margin-bottom:16px}@media (max-width: 768px){.product-image[_ngcontent-%COMP%]{height:180px}.product-title[_ngcontent-%COMP%]{font-size:.95rem}.price[_ngcontent-%COMP%]{font-size:1.1rem}}"]});let t=c;return t})();export{je as Tab1Page};
